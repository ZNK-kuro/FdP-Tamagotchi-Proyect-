;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-advanced-reader.ss" "lang")((modname tamagotchi) (read-case-sensitive #t) (teachpacks ((lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp"))) (htdp-settings #(#t constructor repeating-decimal #t #t none #f ((lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp")) #f)))
#|
  PROYECTO FDP - TAMAGOTCHI
  Archivo: Tamagotchi.rkt

  Autores:                            Código

          Nicolás Jaramillo M.        1840558
          Mateo Obando G.             1844983
          Andrés Pineda C.            1843660

  Fecha creación: 2019/04/01
  Fecha última modificación: 2019/04/01
  Versión: 0.1.1


|#

(define (tamagotchi)
  (local
    (
     (define accs (vector "comer" "jugar" "musica" "baño" "curar"))
     (define cuentaAcciones (make-vector 5 0))
     (define accion 0)
     (define felicidad 3)
     (define causaDeMuerte accion)
     (define estaEnfermo false)
     (define necesitaElBaño false)
#|-------------------------------------------------------------------------------------------------|#
     (define (sumaContadores num)
       (begin
         (vector-set! cuentaAcciones accion (+ 1 (vector-ref cuentaAcciones accion)))
         (if (eq? accion 0)
             (begin
               (if (= (vector-ref cuentaAcciones 1) 0)
                   void
                   (vector-set! cuentaAcciones 1 (- (vector-ref cuentaAcciones 1) 1)))
               (if (= (vector-ref cuentaAcciones 2) 0)
                   void
                   (vector-set! cuentaAcciones 2 (- (vector-ref cuentaAcciones 2) 1)))
               (if (= (vector-ref cuentaAcciones 3) 0)
                   void
                   (vector-set! cuentaAcciones 3 (- (vector-ref cuentaAcciones 3) 1))))
             (if (eq? accion 1)
                 (begin
                   (if (= (vector-ref cuentaAcciones 0) 0)
                       void
                       (vector-set! cuentaAcciones 0 (- (vector-ref cuentaAcciones 0) 1)))
                   (if (= (vector-ref cuentaAcciones 2) 0)
                       void
                       (vector-set! cuentaAcciones 2 (- (vector-ref cuentaAcciones 2) 1)))
                   (if (= (vector-ref cuentaAcciones 3) 0)
                       void
                       (vector-set! cuentaAcciones 3 (- (vector-ref cuentaAcciones 3) 1))))
                 (if (eq? accion 2)
                     (begin
                       (if (= (vector-ref cuentaAcciones 0) 0)
                           void
                           (vector-set! cuentaAcciones 0 (- (vector-ref cuentaAcciones 0) 1)))
                       (if (= (vector-ref cuentaAcciones 1) 0)
                           void
                           (vector-set! cuentaAcciones 1 (- (vector-ref cuentaAcciones 1) 1)))
                       (if (= (vector-ref cuentaAcciones 3) 0)
                           void
                           (vector-set! cuentaAcciones 3 (- (vector-ref cuentaAcciones 3) 1))))
                     (if (eq? accion 3)
                         (begin
                           (if (= (vector-ref cuentaAcciones 0) 0)
                               void
                               (vector-set! cuentaAcciones 0 (- (vector-ref cuentaAcciones 0) 1)))
                           (if (= (vector-ref cuentaAcciones 1) 0)
                               void
                               (vector-set! cuentaAcciones 1 (- (vector-ref cuentaAcciones 1) 1)))
                           (if (= (vector-ref cuentaAcciones 2) 0)
                               void
                               (vector-set! cuentaAcciones 2 (- (vector-ref cuentaAcciones 2) 1))))
                         (if (eq? accion 4)
                             (begin
                               (if (= (vector-ref cuentaAcciones 0) 0)
                                   void
                                   (vector-set! cuentaAcciones 0 (- (vector-ref cuentaAcciones 0) 1)))
                               (if (= (vector-ref cuentaAcciones 1) 0)
                                   void
                                   (vector-set! cuentaAcciones 1 (- (vector-ref cuentaAcciones 1) 1)))
                               (if (= (vector-ref cuentaAcciones 2) 0)
                                   void
                                   (vector-set! cuentaAcciones 2 (- (vector-ref cuentaAcciones 2) 1)))
                               (if (= (vector-ref cuentaAcciones 3) 0)
                                   void
                                   (vector-set! cuentaAcciones 3 (- (vector-ref cuentaAcciones 3) 1))))
                             void)))))))
     #|-------------------------------------------------------------------------------------------------|#
     (define (cerrar num)
       (begin
         (printf "\nEres un mal amo.")
         (cond
           [(eq? num 0) (display "\nTu mascota murió por comer demasiado.")]
           [(eq? num 1) (display "\nTu mascota murió de cansancio.")]
           [(eq? num 2) (display "\nTu mascota murió por derrame cerebral")]
           [(eq? num 3) (display "\nTu mascota murió por falla renal")]
           [(eq? num 5) (display "\nTe has ido")])))
     #|-------------------------------------------------------------------------------------------------|#
     (define (comer)
       (begin
         (if
          (= (vector-ref cuentaAcciones accion) 0)
          (begin 
            (set! felicidad(+ felicidad 1))
            (display "\nBuena comida."))
          (if (= (vector-ref cuentaAcciones accion) 1)
              (display "\nEstoy satisfecho. ~n")
              (if (= (vector-ref cuentaAcciones accion) 2)
                  (begin
                    (set! felicidad(- felicidad 1))
                    (printf "~nNecesito ir al baño, no me siento muy bien.")
                    (set! necesitaElBaño true))
                  (set! causaDeMuerte accion))))
         (sumaContadores accion)))
     ;si no lo lleva inmediatamente le disminuye en 2 la felicidad.
#|-------------------------------------------------------------------------------------------------|#
     (define (jugar)
       (begin
         ;(printf (vector-ref accs 0))
         (if
          (= (vector-ref cuentaAcciones accion) 0)
          (begin 
            (set! felicidad(+ felicidad 2))
            (display "\nQue divertido."))
          (if (= (vector-ref cuentaAcciones accion) 1)
              (begin
                (set! felicidad (+ felicidad 1))
                (display "\nEstoy cansado."))
              (if (= (vector-ref cuentaAcciones accion) 2)
                  (begin
                    (printf "~nTengo hambre.")
                    (vector-set! cuentaAcciones 0 (- (vector-ref cuentaAcciones 0) 1)))
                  (set! causaDeMuerte accion))))
         (sumaContadores accion)))
#|-------------------------------------------------------------------------------------------------|#
     ;Escuchar música una vez aumenta en 2 la felicidad, otra vez le aumenta en 1, y una tercera vez disminuye en 1, lo enferma, debe curarlo.
     (define (musica)
       (begin
         (if
          (= (vector-ref cuentaAcciones accion) 0)
          (begin 
            (set! felicidad(+ felicidad 2))
            (display "\nTiene buen ritmo."))
          (if (= (vector-ref cuentaAcciones accion) 1)
              (begin
                (set! felicidad (+ felicidad 1))
                (display "\nEstoy satisfecho."))
              (if (= (vector-ref cuentaAcciones accion) 2)
                  (begin
                    (set! felicidad(- felicidad 1))
                    (printf "~nNecesito curarme, me duele la cabeza."))
                  (set! causaDeMuerte accion))))
         (sumaContadores accion)))
#|-------------------------------------------------------------------------------------------------|#
     ;El baño le aumenta la felicidad en 2, la segunda vez no lo afecta y la tercera le disminuye en 1 enfermándolo, debe curarlo.
     (define (baño)
       (print "incompleto"))
#|-------------------------------------------------------------------------------------------------|#
     ;Curar una vez le aumenta la felicidad en 3 y más veces no le afecta.
     (define (curar)
       (begin
         (if (= (vector-ref cuentaAcciones accion) 0)
             (set! felicidad (+ felicidad 3))
             void)
         (display "~nEstoy sano")
         (set! estaEnfermo false)
         (sumaContadores accion)))
#|-------------------------------------------------------------------------------------------------|#
     (define mostrarmenu #f)
     (define (menu)
       (if (or (=(vector-ref cuentaAcciones 0) 4)
               (=(vector-ref cuentaAcciones 1) 4)
               (=(vector-ref cuentaAcciones 2) 4)
               (=(vector-ref cuentaAcciones 3) 4)
               (= felicidad 0))
           (cerrar causaDeMuerte)
           (begin
             (if (boolean=? mostrarmenu #f)
                 (begin
                   (printf "~n")
                   (printf "~n******************~n")
                   (printf "****TAMAGOTCHI****~n")
                   (printf "******************~n")
                   (printf "*******MENU*******~n")
                   (printf "******************~n")
                   (set! mostrarmenu #t))
                 void)
             
             (printf "el estado actual de tu tamagotchi es: ~n")
             
             (display "felicidad: ")
             (display felicidad)
             (printf "~n")
             (display "comida: ")
             (display (vector-ref cuentaAcciones 0))
             (printf "~n")
             (display "juego: ")
             (display (vector-ref cuentaAcciones 1))
             (printf "~n")
             (display "musica: ")
             (display (vector-ref cuentaAcciones 2))
             (printf "~n")
             (display "baño: ")
             (display (vector-ref cuentaAcciones 3))
             
             
             
             
             (begin (printf "~nAcciones disponibles:~n")
                    (printf "1. Comer~n")
                    (printf "2. jugar~n")
                    (printf "3. Escuchar música~n")
                    (printf "4. Ir al baño~n")
                    (printf "5. Curar~n")
                    (printf "6. salir~n")
                    (set! accion (- (read) 1))
                    (cond
                      [(= 0 accion) (begin (comer)
                                           (menu))]
                      [(= 1 accion) (begin (jugar)
                                           (menu))]
                      [(= 2 accion) (begin (musica)
                                           (menu))]
                      [(= 3 accion) (begin (baño)
                                           (menu))]
                      [(= 4 accion) (begin (curar)
                                           (menu))]
                      [(= 5 accion) (begin (cerrar 5))]
                      [else (begin
                              (printf "no entiendo que dices")
                              (menu))])))))
     ;Tras cada acción se debe mostrar el nivel de felicidad.
     )(menu)))
(tamagotchi)